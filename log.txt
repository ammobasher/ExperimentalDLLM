Flax classes are deprecated and will be removed in Diffusers v1.0.0. We recommend migrating to PyTorch classes or pinning your version of Diffusers.
Flax classes are deprecated and will be removed in Diffusers v1.0.0. We recommend migrating to PyTorch classes or pinning your version of Diffusers.
Traceback (most recent call last):
  File "/Users/ahmed/Documents/ExperimentalDLLM/reproduce_issue.py", line 19, in <module>
    vae, params = FlaxAutoencoderKL.from_pretrained(model_id, subfolder="vae", revision="flax")
                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ahmed/Documents/ExperimentalDLLM/venv/lib/python3.14/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/Users/ahmed/Documents/ExperimentalDLLM/venv/lib/python3.14/site-packages/diffusers/models/modeling_flax_utils.py", line 442, in from_pretrained
    params_shape_tree = jax.eval_shape(model.init_weights, rng=jax.random.PRNGKey(0))
  File "/Users/ahmed/Documents/ExperimentalDLLM/venv/lib/python3.14/site-packages/diffusers/models/vae_flax.py", line 887, in init_weights
    return self.init(rngs, sample)["params"]
           ~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/ahmed/Documents/ExperimentalDLLM/venv/lib/python3.14/site-packages/diffusers/models/vae_flax.py", line 864, in setup
    self.quant_conv = nn.Conv(
                      ~~~~~~~^
        2 * self.config.latent_channels,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    
    
    )
    ^
  File "/Users/ahmed/Documents/ExperimentalDLLM/venv/lib/python3.14/site-packages/flax/linen/kw_only_dataclasses.py", line 238, in init_wrapper
    dataclass_init(self, *args, **kwargs)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Conv.__init__() got an unexpected keyword argument 'kernel_size'
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
Python Version: 3.14.0 (v3.14.0:ebf955df7a8, Oct  7 2025, 08:20:14) [Clang 16.0.0 (clang-1600.0.26.6)]
Success: Imported FlaxAutoencoderKL
Conv Signature: (strides: Any = 1, padding: Any = 'SAME', input_dilation: Any = 1, kernel_dilation: Any = 1, feature_group_count: Any = 1, use_bias: Any = True, mask: Any = None, dtype: Any = None, precision: Any = None, conv_general_dilated: Any = None, conv_general_dilated_cls: Any = None, shared_weights: Any = <property object at 0x113649580>, parent: flax.linen.module.Module | flax.core.scope.Scope | flax.linen.module._Sentinel | None = <flax.linen.module._Sentinel object at 0x1135f8d70>, name: str | None = None) -> None
Loading VAE from CompVis/stable-diffusion-v1-4 (revision='flax')...
